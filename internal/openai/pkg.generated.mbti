// Generated using `moon info`, DON'T EDIT IT
package "moonbitlang/maria/internal/openai"

import(
  "moonbitlang/core/json"
  "moonbitlang/maria/internal/pino"
  "moonbitlang/maria/internal/schema"
  "moonbitlang/maria/model"
)

// Values
pub fn[T : ToChatCompletionMessageParamContent] assistant_message(content? : T, tool_calls? : Array[ChatCompletionMessageToolCall], name? : String) -> ChatCompletionMessageParam

pub async fn chat(model~ : @model.Model, Request, logger? : @pino.Logger, extra_body? : Map[String, Json]) -> ChatCompletion

pub fn chat_completion(model~ : String, messages~ : Array[ChatCompletionMessageParam], tools? : Array[ChatCompletionToolParam], usage? : CompletionUsageParam, user? : String, max_tokens? : Int, temperature? : Double, reasoning_effort? : ChatCompletionReasoningEffort, response_format? : ResponseFormat, stream? : Bool, stream_options? : ChatCompletionStreamOptionsParam, tool_choice? : ChatCompletionToolChoice) -> Request

pub fn chunk(id~ : String, choices~ : Array[ChatCompletionChunkChoice], created~ : Int, model~ : String, usage? : CompletionUsage, system_fingerprint? : String, service_tier? : ChatCompletionServiceTier, error? : OpenRouterErrorResponse) -> ChatCompletionChunk

pub fn chunk_choice(index~ : Int, delta~ : ChatCompletionChunkChoiceDelta, finish_reason? : ChatCompletionChoiceFinishReason) -> ChatCompletionChunkChoice

pub fn chunk_choice_delta(content? : String, refusal? : String, role? : ChatCompletionRole, tool_calls? : Array[ChatCompletionChunkChoiceDeltaToolCall]) -> ChatCompletionChunkChoiceDelta

pub fn chunk_choice_delta_tool_call(index~ : Int, id? : String, function~ : ChatCompletionChunkChoiceDeltaToolCallFunction) -> ChatCompletionChunkChoiceDeltaToolCall

pub fn chunk_choice_delta_tool_call_function(arguments? : String, name? : String) -> ChatCompletionChunkChoiceDeltaToolCallFunction

pub async fn[T : Structural] data(model~ : @model.Model, prompt~ : String) -> T

pub async fn json(model~ : @model.Model, prompt~ : String) -> Json

pub fn json_schema(name~ : String, schema~ : Map[String, Json], description? : String, strict? : Bool) -> ResponseFormat

pub fn stream_options(include_obfuscation? : Bool, include_usage? : Bool) -> ChatCompletionStreamOptionsParam

pub fn[T : ToChatCompletionMessageParamContent] system_message(content~ : T, name? : String) -> ChatCompletionMessageParam

pub async fn text(model~ : @model.Model, prompt~ : String) -> String

pub fn text_content_part(String, cache_control? : CacheControl) -> ChatCompletionContentPartParam

pub fn tool(name~ : String, description~ : String, parameters~ : Json, strict? : Bool) -> ChatCompletionToolParam

pub fn tool_call(id~ : String, name~ : String, arguments? : String) -> ChatCompletionMessageToolCall

pub fn[T : ToChatCompletionMessageParamContent] tool_message(content~ : T, tool_call_id~ : String) -> ChatCompletionMessageParam

pub fn usage(include_~ : Bool) -> CompletionUsageParam

pub fn[T : ToChatCompletionMessageParamContent] user_message(content~ : T, name? : String) -> ChatCompletionMessageParam

// Errors

// Types and methods
pub(all) enum CacheControl {
  Ephemeral
}
pub impl ToJson for CacheControl

pub struct ChatCompletion {
  id : String
  choices : Array[ChatCompletionChoice]
  created : Int
  model : String
  usage : CompletionUsage?
  system_fingerprint : String?
  service_tier : ChatCompletionServiceTier?
}
pub fn ChatCompletion::new(id~ : String, choices~ : Array[ChatCompletionChoice], created~ : Int, model~ : String, usage? : CompletionUsage, system_fingerprint? : String, service_tier? : ChatCompletionServiceTier) -> Self
pub impl Show for ChatCompletion
pub impl ToJson for ChatCompletion
pub impl @json.FromJson for ChatCompletion

pub(all) struct ChatCompletionAllowedTools {
  mode : ChatCompletionAllowedToolsMode
  tools : Array[ChatCompletionToolChoice]
}

pub(all) enum ChatCompletionAllowedToolsMode {
  Auto
  Required
}

pub struct ChatCompletionAssistantMessageParam {
  content : Array[ChatCompletionContentPartParam]
  name : String?
  tool_calls : Array[ChatCompletionMessageToolCall]
}

pub struct ChatCompletionChoice {
  finish_reason : ChatCompletionChoiceFinishReason?
  index : Int
  message : ChatCompletionMessage
}
pub fn ChatCompletionChoice::new(finish_reason? : ChatCompletionChoiceFinishReason, index~ : Int, message~ : ChatCompletionMessage) -> Self
pub impl Show for ChatCompletionChoice

pub(all) enum ChatCompletionChoiceFinishReason {
  Stop
  Length
  ToolCalls
  ContentFilter
  FunctionCall
}
pub impl Show for ChatCompletionChoiceFinishReason

pub struct ChatCompletionChunk {
  id : String
  choices : Array[ChatCompletionChunkChoice]
  created : Int
  model : String
  usage : CompletionUsage?
  system_fingerprint : String?
  service_tier : ChatCompletionServiceTier?
  error : OpenRouterErrorResponse?
}
pub impl ToJson for ChatCompletionChunk
pub impl @json.FromJson for ChatCompletionChunk

pub struct ChatCompletionChunkChoice {
  index : Int
  delta : ChatCompletionChunkChoiceDelta
  finish_reason : ChatCompletionChoiceFinishReason?
}
pub impl ToJson for ChatCompletionChunkChoice

pub struct ChatCompletionChunkChoiceDelta {
  content : String?
  refusal : String?
  role : ChatCompletionRole?
  tool_calls : Array[ChatCompletionChunkChoiceDeltaToolCall]?
}
pub impl ToJson for ChatCompletionChunkChoiceDelta

pub struct ChatCompletionChunkChoiceDeltaToolCall {
  index : Int
  id : String?
  function : ChatCompletionChunkChoiceDeltaToolCallFunction
}
pub impl ToJson for ChatCompletionChunkChoiceDeltaToolCall

pub struct ChatCompletionChunkChoiceDeltaToolCallFunction {
  arguments : String?
  name : String?
}
pub impl ToJson for ChatCompletionChunkChoiceDeltaToolCallFunction

pub enum ChatCompletionContentPartParam {
  Text(ChatCompletionContentPartTextParam)
}
pub fn ChatCompletionContentPartParam::new(text~ : String, cache_control? : CacheControl) -> Self
pub impl ToJson for ChatCompletionContentPartParam
pub impl ToChatCompletionMessageParamContent for ChatCompletionContentPartParam

pub struct ChatCompletionContentPartTextParam {
  text : String
  cache_control : CacheControl?
}

pub(all) struct ChatCompletionCustomToolChoice {
  name : String
}

pub(all) struct ChatCompletionFunctionToolChoice {
  name : String
}

pub struct ChatCompletionMessage {
  content : String?
  refusal : String?
  role : ChatCompletionMessageRole
  tool_calls : Array[ChatCompletionMessageToolCall]
}
pub fn ChatCompletionMessage::new(content? : String, refusal? : String, role? : ChatCompletionMessageRole, tool_calls? : Array[ChatCompletionMessageToolCall]) -> Self
pub fn ChatCompletionMessage::to_param(Self) -> ChatCompletionMessageParam
pub impl Show for ChatCompletionMessage
pub impl ToJson for ChatCompletionMessage
pub impl @json.FromJson for ChatCompletionMessage

pub(all) enum ChatCompletionMessageParam {
  System(ChatCompletionSystemMessageParam)
  User(ChatCompletionUserMessageParam)
  Assistant(ChatCompletionAssistantMessageParam)
  Tool(ChatCompletionToolMessageParam)
}
pub impl ToJson for ChatCompletionMessageParam
pub impl @json.FromJson for ChatCompletionMessageParam

pub enum ChatCompletionMessageRole {
  Assistant
}
pub impl Show for ChatCompletionMessageRole
pub impl ToJson for ChatCompletionMessageRole

#alias(ChatCompletionMessageToolCallParam)
pub struct ChatCompletionMessageToolCall {
  id : String
  function : ChatCompletionMessageToolCallFunction
}
pub impl Show for ChatCompletionMessageToolCall
pub impl ToJson for ChatCompletionMessageToolCall
pub impl @json.FromJson for ChatCompletionMessageToolCall

pub struct ChatCompletionMessageToolCallFunction {
  arguments : String?
  name : String
}
pub impl Show for ChatCompletionMessageToolCallFunction

pub(all) enum ChatCompletionReasoningEffort {
  None_
  Minimal
  Low
  Medium
  High
  Xhigh
}
pub impl Show for ChatCompletionReasoningEffort

pub(all) enum ChatCompletionRole {
  Developer
  System
  User
  Assistant
  Tool
}
pub impl ToJson for ChatCompletionRole

#alias(ChatCompletionChunkServiceTier)
pub(all) enum ChatCompletionServiceTier {
  Auto
  Default
  Flex
  Scale
  Priority
}
pub impl Show for ChatCompletionServiceTier

pub struct ChatCompletionStreamOptionsParam {
  include_obfuscation : Bool?
  include_usage : Bool?
}
pub impl ToJson for ChatCompletionStreamOptionsParam

pub struct ChatCompletionSystemMessageParam {
  content : Array[ChatCompletionContentPartParam]
  name : String?
}

pub(all) enum ChatCompletionToolChoice {
  Disallow
  Auto
  Required
  AllowedTools(ChatCompletionAllowedTools)
  Function(ChatCompletionFunctionToolChoice)
  Custom(ChatCompletionCustomToolChoice)
}

pub struct ChatCompletionToolMessageParam {
  content : Array[ChatCompletionContentPartParam]
  tool_call_id : String
}

pub enum ChatCompletionToolParam {
  Function(FunctionDefinition)
}
pub impl ToJson for ChatCompletionToolParam

pub struct ChatCompletionUserMessageParam {
  content : Array[ChatCompletionContentPartParam]
  name : String?
}
pub fn ChatCompletionUserMessageParam::new(content~ : Array[ChatCompletionContentPartParam], name? : String) -> Self

pub struct CompletionTokensDetails {
  reasoning_tokens : Int?
}
pub impl Show for CompletionTokensDetails
pub impl ToJson for CompletionTokensDetails

pub struct CompletionUsage {
  completion_tokens : Int
  completion_tokens_details : CompletionTokensDetails?
  cost : Double?
  cost_details : CostDetails?
  prompt_tokens : Int
  prompt_tokens_details : PromptTokensDetails?
  total_tokens : Int
}
pub fn CompletionUsage::new(completion_tokens~ : Int, completion_tokens_details? : CompletionTokensDetails, cost? : Double, cost_details? : CostDetails, prompt_tokens~ : Int, prompt_tokens_details? : PromptTokensDetails, total_tokens~ : Int) -> Self
pub impl Show for CompletionUsage
pub impl ToJson for CompletionUsage
pub impl @json.FromJson for CompletionUsage

pub struct CompletionUsageParam {
  include_ : Bool
}

pub struct CostDetails {
  upstream_inference_cost : Double?
}
pub impl Show for CostDetails
pub impl ToJson for CostDetails

pub struct FunctionDefinition {
  name : String
  description : String
  parameters : Json
  strict : Bool?
}

type JsonSchema

pub struct OpenRouterErrorResponse {
  code : Int
  message : String
  metadata : Json
}
pub impl ToJson for OpenRouterErrorResponse
pub impl @json.FromJson for OpenRouterErrorResponse

pub struct PromptTokensDetails {
  cached_tokens : Int?
  audio_tokens : Int?
}
pub fn PromptTokensDetails::new(cached_tokens? : Int, audio_tokens? : Int) -> Self
pub impl Show for PromptTokensDetails
pub impl ToJson for PromptTokensDetails

pub struct Request {
  model : String
  messages : Array[ChatCompletionMessageParam]
  tools : Array[ChatCompletionToolParam]
  usage : CompletionUsageParam?
  user : String?
  max_tokens : Int?
  temperature : Double?
  reasoning_effort : ChatCompletionReasoningEffort?
  response_format : ResponseFormat?
  stream : Bool?
  stream_options : ChatCompletionStreamOptionsParam?
  tool_choice : ChatCompletionToolChoice?
}
pub impl ToJson for Request

pub(all) enum ResponseFormat {
  Text
  JsonSchema(JsonSchema)
  JsonObject
}
pub impl ToJson for ResponseFormat

// Type aliases

// Traits
pub(open) trait Structural : @json.FromJson {
  name() -> String
  description() -> String
  schema() -> @schema.Schema
}

trait ToChatCompletionMessageParamContent
pub impl ToChatCompletionMessageParamContent for String
pub impl[T : ToChatCompletionMessageParamContent] ToChatCompletionMessageParamContent for Array[T]
pub impl ToChatCompletionMessageParamContent for StringView

